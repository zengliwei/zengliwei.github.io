(function(e,E){typeof exports=="object"&&typeof module<"u"?module.exports=E(require("vue")):typeof define=="function"&&define.amd?define(["vue"],E):(e=typeof globalThis<"u"?globalThis:e||self,e["v3-d-table"]=E(e.Vue))})(this,function(e){"use strict";var E=document.createElement("style");E.textContent=`.v3-d-table .v3-d-table-main-action{background:var(--v3-d-table-button-bg);border:1px solid var(--v3-d-table-border-color);border-radius:var(--v3-d-table-button-border-radius);color:var(--v3-d-table-button-color);cursor:pointer;line-height:var(--v3-d-table-button-height);height:calc(var(--v3-d-table-button-height) + 2px);padding:var(--v3-d-table-button-padding)}.v3-d-table .v3-d-table-action-box{display:flex}.v3-d-table .v3-d-table-action-box .v3-d-table-main-action{border-top-right-radius:0;border-bottom-right-radius:0}.v3-d-table .v3-d-table-actions-expander{background:var(--v3-d-table-button-bg);border-color:var(--v3-d-table-border-color);border-style:solid;border-width:1px 1px 1px 0;border-top-right-radius:var(--v3-d-table-button-border-radius);border-bottom-right-radius:var(--v3-d-table-button-border-radius);cursor:pointer;display:block;padding:var(--v3-d-table-actions-expander-padding)}.v3-d-table .v3-d-table-actions-expander:after{background:var(--v3-d-table-actions-expander-icon-url) no-repeat center center;background-size:var(--v3-d-table-actions-expander-icon-width) var(--v3-d-table-actions-expander-icon-height);content:"";display:block;height:var(--v3-d-table-actions-expander-icon-height);width:var(--v3-d-table-actions-expander-icon-width)}.v3-d-table-actions-dropdown{background:var(--v3-d-table-actions-dropdown-bg);border:1px solid var(--v3-d-table-border-color);border-radius:var(--v3-d-table-button-border-radius);display:none;min-width:var(--v3-d-table-actions-dropdown-min-width);overflow:hidden;position:absolute;z-index:var(--v3-d-table-actions-dropdown-z-index)}.v3-d-table-actions-dropdown.expanded{display:block}.v3-d-table-actions-dropdown-action{background:var(--v3-d-table-actions-dropdown-action-bg);border-bottom:1px solid var(--v3-d-table-border-color);color:var(--v3-d-table-button-color);cursor:pointer;display:block;font-size:var(--v3-d-table-actions-dropdown-action-font-size);padding:var(--v3-d-table-actions-dropdown-action-padding)}.v3-d-table-actions-dropdown-action:last-child{border-bottom:0}.v3-d-table-actions-dropdown-action:hover{background:var(--v3-d-table-actions-dropdown-action-hover-bg)}.v3-d-table .v3-d-table-action:hover{background:var(--v3-d-table-button-hover-bg)}.v3-d-table .v3-d-table-action:last-child{border-bottom:0}.v3-d-table{border-color:var(--v3-d-table-border-color);border-style:solid;border-width:1px;position:relative;width:var(100%)}.v3-d-table *{box-sizing:border-box}.v3-d-table table{border-collapse:separate;border-spacing:0;table-layout:fixed;width:100%}.v3-d-table th,.v3-d-table td{border-color:var(--v3-d-table-border-color);border-style:solid;border-top-width:0;border-left-width:0;border-bottom-width:1px;border-right-width:1px;line-height:var(--v3-d-table-line-height);padding:var(--v3-d-table-cell-padding)}.v3-d-table th:last-child,.v3-d-table td:last-child{border-right-width:1px}.v3-d-table th.checkbox>div,.v3-d-table td.checkbox>div{justify-content:center}.v3-d-table th>div,.v3-d-table td>div{display:flex;align-items:center;padding:var(--v3-d-table-cell-box-padding)}.v3-d-table .v3-d-table-cell-lv{padding-left:var(--v3-d-table-cell-lv-padding);position:relative;height:var(--v3-d-table-line-height);width:var(--v3-d-table-cell-lv-base-width)}.v3-d-table .v3-d-table-cell-lv.lv1{width:calc(var(--v3-d-table-cell-lv-base-width) + var(--v3-d-table-cell-lv-width) * 1)}.v3-d-table .v3-d-table-cell-lv.lv2{width:calc(var(--v3-d-table-cell-lv-base-width) + var(--v3-d-table-cell-lv-width) * 2)}.v3-d-table .v3-d-table-cell-lv.lv3{width:calc(var(--v3-d-table-cell-lv-base-width) + var(--v3-d-table-cell-lv-width) * 3)}.v3-d-table .v3-d-table-cell-lv.lv4{width:calc(var(--v3-d-table-cell-lv-base-width) + var(--v3-d-table-cell-lv-width) * 4)}.v3-d-table .v3-d-table-cell-expander{cursor:pointer;display:block;background:var(--v3-d-table-cell-expander-icon-url) no-repeat center center;background-size:var(--v3-d-table-cell-expander-icon-width) var(--v3-d-table-cell-expander-icon-height);left:var(--v3-d-table-cell-expander-icon-left);top:var(--v3-d-table-cell-expander-icon-top);height:var(--v3-d-table-line-height);width:var(--v3-d-table-cell-expander-icon-width);position:absolute}.v3-d-table .v3-d-table-cell-expander.loading{background-image:var(--v3-d-table-cell-expander-loading-icon-url)}.v3-d-table .v3-d-table-cell-expander.expanded{background-image:var(--v3-d-table-cell-expander-expanded-icon-url)}.v3-d-table .v3-d-table-main{overflow:auto;position:relative}.v3-d-table .v3-d-table-toolbar{background:var(--v3-d-table-toolbar-bg);border-style:solid;border-width:0 0 1px 0;border-color:var(--v3-d-table-border-color);display:flex;align-items:center;justify-content:space-between;font-size:var(--v3-d-table-toolbar-font-size);padding:var(--v3-d-table-toolbar-padding);position:sticky;left:0;top:0;z-index:3}.v3-d-table .v3-d-table-toolbar>div{display:flex;align-items:center;gap:var(--v3-d-table-toolbar-gap);position:relative}.v3-d-table .v3-d-table-toolbar-actions{display:flex;align-items:center;gap:var(--v3-d-table-toolbar-actions-gap)}.v3-d-table .v3-d-table-header{position:sticky;top:0;z-index:3}.v3-d-table .v3-d-table-header-checked-status{color:var(--v3-d-table-header-checked-status-color)}.v3-d-table .v3-d-table-header table{position:relative;z-index:1}.v3-d-table .v3-d-table-header th{background:var(--v3-d-table-header-lv1-bg);color:var(--v3-d-table-header-color);font-size:var(--v3-d-table-header-font-size);font-weight:var(--v3-d-table-header-font-weight);position:relative;text-align:left;z-index:1}.v3-d-table .v3-d-table-header tr.lv2 th{background:var(--v3-d-table-header-lv2-bg)}.v3-d-table .v3-d-table-header th.sort>div{cursor:pointer;display:flex;align-items:center}.v3-d-table .v3-d-table-header th.sort>div>span{flex:1 1 auto}.v3-d-table .v3-d-table-header th.sort>div:after{background:var(--v3-d-table-header-sort-icon-url) no-repeat center center;background-size:var(--v3-d-table-header-sort-icon-width) var(--v3-d-table-header-sort-icon-height);content:"";display:block;height:var(--v3-d-table-header-sort-icon-height);width:var(--v3-d-table-header-sort-icon-width)}.v3-d-table .v3-d-table-header th.sort.asc>div:after{background-image:var(--v3-d-table-header-sort-asc-icon-url)}.v3-d-table .v3-d-table-header th.sort.desc>div:after{background-image:var(--v3-d-table-header-sort-desc-icon-url)}.v3-d-table .v3-d-table-header th.actions,.v3-d-table .v3-d-table-body td.actions{width:var(--v3-d-table-header-actions-width)}.v3-d-table .v3-d-table-body{z-index:1}.v3-d-table .v3-d-table-body tr td{background-color:var(--v3-d-table-body-row-bg)}.v3-d-table .v3-d-table-body tr:nth-child(2n) td{background-color:var(--v3-d-table-body-row-even-bg)}.v3-d-table .v3-d-table-body tr:hover td{background-color:var(--v3-d-table-body-row-hover-bg)}.v3-d-table .v3-d-table-body tr.activated td{background-color:var(--v3-d-table-body-row-activated-bg)}.v3-d-table .v3-d-table-body td>div{color:var(--v3-d-table-body-color);font-size:var(--v3-d-table-body-font-size);font-weight:var(--v3-d-table-body-font-weight);overflow:hidden;text-overflow:ellipsis}.v3-d-table .v3-d-table-body td.align-center>div{justify-content:center}.v3-d-table .v3-d-table-body td.align-right>div{justify-content:flex-end}.v3-d-table .v3-d-table-body td.actions>div{font-size:var(--v3-d-table-body-row-actions-font-size);line-height:var(--v3-d-table-body-row-actions-line-height)}.v3-d-table .v3-d-table-body td.no-data{background-color:var(--v3-d-table-cell-no-data-bg);padding:var(--v3-d-table-cell-no-data-padding);border-bottom:0}.v3-d-table .v3-d-table-body td.no-data:hover{background:none}.v3-d-table .v3-d-table-body td.no-data>div{justify-content:center}.v3-d-table .v3-d-table-footer{background:var(--v3-d-table-footer-bg);border-color:var(--v3-d-table-border-color);border-style:solid;border-width:1px 0 0 0;display:flex;align-items:center;justify-content:space-between;font-size:var(--v3-d-table-footer-font-size)}.v3-d-table .v3-d-table-footer>div{padding:var(--v3-d-table-footer-padding)}.v3-d-table .v3-d-table-footer .paginator{display:flex;align-items:center;gap:var(--v3-d-table-paginator-gap)}.v3-d-table .v3-d-table-footer .paginator a{color:var(--v3-d-table-paginator-link-color)}.v3-d-table .v3-d-table-footer .paginator a.disabled{color:var(--v3-d-table-paginator-link-disabled-color);cursor:not-allowed}.v3-d-table .v3-d-table-footer .paginator select{padding:var(--v3-d-table-paginator-select-padding)}.v3-d-table a{color:var(--v3-d-table-link-color);text-decoration:none}.v3-d-table select{border:1px solid var(--v3-d-table-border-color);border-radius:var(--v3-d-table-select-border-radius);color:inherit;display:block;font-size:inherit;height:var(--v3-d-table-select-height);outline:none;padding:var(--v3-d-table-select-padding);width:100%}.v3-d-table input[type=email],.v3-d-table input[type=text],.v3-d-table input[type=password]{border:1px solid var(--v3-d-table-border-color);border-radius:var(--v3-d-table-select-border-radius);color:inherit;display:block;font-size:inherit;height:var(--v3-d-table-input-height);outline:none;padding:var(--v3-d-table-input-padding);width:100%}.v3-d-table button{background:var(--v3-d-table-button-bg);border:1px solid var(--v3-d-table-border-color);color:var(--v3-d-table-button-color);cursor:pointer;display:block;outline:none;border-radius:var(--v3-d-table-button-border-radius);font-size:var(--v3-d-table-button-font-size);line-height:var(--v3-d-table-button-height);min-width:var(--v3-d-table-button-min-width);height:calc(var(--v3-d-table-button-height) + 2px);padding:var(--v3-d-table-button-padding)}.v3-d-table button:hover{background:var(--v3-d-table-button-hover-bg)}
`,document.head.appendChild(E);const J=["v-slot"],K=["innerHTML"],X={__name:"v3-d-table-td",props:{col:{type:Object,required:!0},row:{type:Object,required:!0},lastLeftFixedColIdx:{type:Number,default:-1},level:{type:Number,default:0},emptyValue:{type:String,default:"-"}},emits:["click","dblclick","mouseenter","mouseleave"],setup(t){const p=t,g=function(a,o){let f=o.renderer&&o.renderer instanceof Function?o.renderer(a,o):a[o.code];return[void 0,null,""].indexOf(f)>-1&&(f=p.emptyValue),f},y=function(a){a.children&&a.children.forEach(o=>{o._hidden_=!a._expanded_,y(o)})},i=function(a){a.children&&a.children.forEach(o=>{o._hidden_=!0,i(o)})},m=async function(a){a._expanded_=!a._expanded_,a._expanded_?(!a.children&&p.col.srcGetChildren instanceof Function&&(a._loading_=!0,a.children=await p.col.srcGetChildren(a),a._loading_=!1),y(a)):i(a)};return(a,o)=>t.col.type==="data"&&!t.col.hidden?(e.openBlock(),e.createElementBlock("td",{key:0,class:e.normalizeClass(t.col.cssClass),style:e.normalizeStyle(t.col.style),onClick:o[1]||(o[1]=f=>a.$emit("click")),onDblclick:o[2]||(o[2]=f=>a.$emit("dblclick")),onMouseenter:o[3]||(o[3]=f=>a.$emit("mouseenter")),onMouseleave:o[4]||(o[4]=f=>a.$emit("mouseleave"))},[e.createElementVNode("div",null,[t.col.expandable?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(`v3-d-table-cell-lv lv${t.level}`)},[t.row.children?(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass({"v3-d-table-cell-expander":!0,loading:t.row._loading_,expanded:t.row._expanded_}),onClick:o[0]||(o[0]=e.withModifiers(f=>m(t.row),["prevent","stop"]))},null,2)):e.createCommentVNode("",!0)],2)):e.createCommentVNode("",!0),t.col.tpl?(e.openBlock(),e.createElementBlock("div",{key:1,class:"flex-fill","v-slot":t.col.tpl},null,8,J)):(e.openBlock(),e.createElementBlock("div",{key:2,class:"flex-fill",innerHTML:g(t.row,t.col)},null,8,K))])],38)):e.createCommentVNode("",!0)}},Q=(t,p)=>{const g=t.__vccOpts||t;for(const[y,i]of p)g[y]=i;return g},V=e.reactive([]),Y={name:"v3-d-table-actions",expose:["close"],props:{actions:{type:Array,required:!0}},data:function(){return{expanded:!1,myActions:this.actions.filter(t=>t.canShow instanceof Function?t.canShow(...t.params||[]):!0),dropdownStyle:{}}},methods:{closeOthers:function(){V.forEach(t=>{this!==t&&t.close()})},handleAction:function(t){this.closeOthers(),t.handle(...t.params||[]),this.expanded=!1},dropdown:function(){if(this.expanded){this.expanded=!1;return}this.closeOthers(),this.expanded=!0;let t=this.$refs.elActionBox.getBoundingClientRect(),p=this.$refs.elDropdown.getBoundingClientRect();this.dropdownStyle.left=window.innerWidth-(t.x+p.width)>0?`${t.x}px`:`${t.x+t.width-p.width}px`,this.dropdownStyle.top=window.innerHeight-(t.y+p.height)>0?`${t.y+t.height+1}px`:`${t.y-p.height-1}px`},close:function(){this.expanded=!1},docClickListener:function(t){this.$refs.elContainer.contains(t.target)||(this.expanded=!1)}},mounted:function(){V.push(this),document.addEventListener("click",this.docClickListener)},unmounted:function(){V.splice(V.indexOf(this),1),document.removeEventListener("click",this.docClickListener)}},Z={class:"v3-d-table-actions",ref:"elContainer"},_=["textContent"],ee={ref:"elActionBox",class:"v3-d-table-action-box"},te=["textContent"],le=["textContent","onClick"];function ae(t,p,g,y,i,m){return e.openBlock(),e.createElementBlock("div",Z,[t.myActions.length===1?(e.openBlock(),e.createElementBlock("a",{key:0,class:"v3-d-table-action",textContent:e.toDisplayString(t.myActions[0].label),onClick:p[0]||(p[0]=e.withModifiers(a=>m.handleAction(t.myActions[0]),["stop"]))},null,8,_)):e.createCommentVNode("",!0),t.myActions.length>1?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createElementVNode("div",ee,[e.createElementVNode("a",{class:"v3-d-table-main-action",textContent:e.toDisplayString(t.myActions[0].label),onClick:p[1]||(p[1]=e.withModifiers(a=>m.handleAction(t.myActions[0]),["stop"]))},null,8,te),e.createElementVNode("span",{class:"v3-d-table-actions-expander",onClick:p[2]||(p[2]=e.withModifiers(a=>m.dropdown(a),["stop"]))})],512),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{ref:"elDropdown",class:e.normalizeClass({"v3-d-table-actions-dropdown":!0,expanded:t.expanded}),style:e.normalizeStyle(t.dropdownStyle)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.myActions,(a,o)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[o>0?(e.openBlock(),e.createElementBlock("a",{key:0,class:"v3-d-table-actions-dropdown-action",textContent:e.toDisplayString(a.label),onClick:e.withModifiers(f=>m.handleAction(a),["stop"])},null,8,le)):e.createCommentVNode("",!0)],64))),256))],6)]))],64)):e.createCommentVNode("",!0)],512)}const L=Q(Y,[["render",ae]]),oe=["checked"],ne=["textContent"],re={key:0},de={__name:"v3-d-table-tr",props:{idx:{type:Number},row:{type:Object,required:!0},cols:{type:Array,required:!0},showAutoWidthCol:{type:Boolean,default:!1},emptyValue:{type:String,default:"-"},lastLeftFixedColIdx:{type:Number,default:-1},activatedRows:{type:Array,default:()=>[]},level:{type:Number,default:0}},emits:["click","dblclick","mouseenter","mouseleave","check","cell-click","cell-dblclick","cell-mouseenter","cell-mouseleave"],setup(t,{emit:p}){const g=p,y=t,i=function(a){g("check",y.row,a)},m=function(a,o){return a.map(f=>({label:f.label,canShow:f.canShow,handle:f.handle,params:[o]}))};return(a,o)=>{const f=e.resolveComponent("v3-d-table-tr",!0);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("tr",{ref:"tr",class:e.normalizeClass({activated:t.activatedRows.indexOf(t.row)>-1,hidden:t.row._hidden_}),onClick:o[2]||(o[2]=b=>a.$emit("click",t.row)),onDblclick:o[3]||(o[3]=b=>a.$emit("dblclick",t.row))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.cols,(b,h)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[b.type==="checkbox"?(e.openBlock(),e.createElementBlock("td",{key:0,class:"checkbox",style:e.normalizeStyle(b.style)},[e.createElementVNode("div",null,[e.createElementVNode("input",{type:"checkbox",checked:t.row._checked_,onClick:o[0]||(o[0]=e.withModifiers(()=>{},["stop"])),onChange:o[1]||(o[1]=k=>i(k.currentTarget.checked))},null,40,oe)])],4)):e.createCommentVNode("",!0),b.type==="index"?(e.openBlock(),e.createElementBlock("td",{key:1,class:"index",style:e.normalizeStyle(b.style)},[e.createElementVNode("div",{textContent:e.toDisplayString(t.idx+1||"")},null,8,ne)],4)):e.createCommentVNode("",!0),b.type==="actions"?(e.openBlock(),e.createElementBlock("td",{key:2,class:"actions",style:e.normalizeStyle(b.style)},[e.createElementVNode("div",null,[e.createVNode(L,{actions:m(b.actions,t.row)},null,8,["actions"])])],4)):e.createCommentVNode("",!0),e.createVNode(X,{ref_for:!0,ref:"td",col:b,row:t.row,"row-idx":t.idx,level:t.level,"empty-value":t.emptyValue,class:e.normalizeClass({data:!0,"last-fixed-left":t.lastLeftFixedColIdx===h}),onClick:k=>a.$emit("cell-click",t.row,b),onDblclick:k=>a.$emit("cell-dblclick",t.row,b),onMouseenter:k=>a.$emit("cell-mouseenter",t.row,b),onMouseleave:k=>a.$emit("cell-mouseleave",t.row,b)},null,8,["col","row","row-idx","level","empty-value","class","onClick","onDblclick","onMouseenter","onMouseleave"])],64))),256)),t.showAutoWidthCol?(e.openBlock(),e.createElementBlock("td",re)):e.createCommentVNode("",!0)],34),t.row.children&&t.row._expanded_?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(t.row.children,b=>(e.openBlock(),e.createBlock(f,{row:b,cols:t.cols,"show-auto-width-col":t.showAutoWidthCol,"empty-value":t.emptyValue,"last-left-fixed-col-idx":t.lastLeftFixedColIdx,"activated-rows":t.activatedRows,level:t.level+1,onClick:o[4]||(o[4]=h=>a.$emit("click",h)),onDblclick:o[5]||(o[5]=h=>a.$emit("dblclick",h)),onMouseenter:o[6]||(o[6]=h=>a.$emit("mouseenter",h)),onMouseleave:o[7]||(o[7]=h=>a.$emit("mouseleave",h)),onCheck:o[8]||(o[8]=(h,k)=>a.$emit("check",h,k)),onCellClick:o[9]||(o[9]=(h,k)=>a.$emit("cell-click",h,k)),onCellDblclick:o[10]||(o[10]=(h,k)=>a.$emit("cell-dblclick",h,k)),onCellMouseenter:o[11]||(o[11]=(h,k)=>a.$emit("cell-mouseenter",h,k)),onCellMouseleave:o[12]||(o[12]=(h,k)=>a.$emit("cell-mouseleave",h,k))},null,8,["row","cols","show-auto-width-col","empty-value","last-left-fixed-col-idx","activated-rows","level"]))),256)):e.createCommentVNode("",!0)],64)}}},ie={__name:"v3-d-table-filter-text",props:{value:{type:String}},emits:["update:value","execute"],setup(t,{emit:p}){const g=p,y=t,i=e.computed({get:()=>y.value,set:a=>g("update:value",a)}),m=function(a){a.code==="Enter"&&g("execute")};return(a,o)=>e.withDirectives((e.openBlock(),e.createElementBlock("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=f=>i.value=f),onKeyup:m},null,544)),[[e.vModelText,i.value]])}},se=["value","textContent"],ce={__name:"v3-d-table-filter-select",props:{value:{type:String},options:{type:Array}},emits:["update:value","execute"],setup(t,{emit:p}){const g=p,y=t,i=e.computed({get:()=>y.value,set:a=>g("update:value",a)}),m=function(){g("execute")};return(a,o)=>e.withDirectives((e.openBlock(),e.createElementBlock("select",{"onUpdate:modelValue":o[0]||(o[0]=f=>i.value=f),onChange:m},[o[1]||(o[1]=e.createElementVNode("option",{value:""},null,-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.options,f=>(e.openBlock(),e.createElementBlock("option",{value:f.value,textContent:e.toDisplayString(f.label)},null,8,se))),256))],544)),[[e.vModelSelect,i.value]])}},be={class:"v3-d-table-toolbar-left"},pe={class:"v3-d-table-toolbar-actions"},fe=["textContent"],he={class:"v3-d-table-toolbar-right"},ve=["textContent"],me=["textContent"],ke=["onClick"],ue=["textContent"],ge={key:0,class:"auto"},ye={key:0},xe={key:0,class:"auto"},we={key:1},Ce=["colspan"],Be=["textContent"],Ee={class:"v3-d-table-page-sizes"},Ne=["value","selected","textContent"],Ve=["textContent"],$e={class:"paginator"},Se=["textContent"],ze=["value","selected","textContent"],Ae=["textContent"];return{__name:"v3-d-table",props:{columns:{type:Array,required:!0},showToolbar:{type:Boolean,default:!0},toolbarActions:{type:Array,default:()=>[]},showColumnFilter:{type:Boolean,default:!0},customFilterTypes:{type:Object},data:{type:Array,default:[]},srcUrl:{type:String},srcMethod:{type:String,default:"GET"},srcHeaders:{type:Object,default:{Accept:"application/json"}},srcParams:{type:Array},srcHandler:{type:Function},height:{type:String},autoLoad:{type:Boolean,default:!0},pageSize:{type:Number,default:50},pageSizes:{type:Array,default:[20,50,100,200]},page:{type:Number,default:1},i18nCheckedStatus:{type:String,default:":checked item(s) checked"},i18nPaging:{type:String,default:"Page :page of :page_count (:row_total items)"},i18nNoData:{type:String,default:"No matched data"},emptyValue:{type:String,default:"-"},i18nPrevPage:{type:String,default:"Prev"},i18nNextPage:{type:String,default:"Next"}},emits:["row-click","row-dblclick","row-mouseenter","row-mouseleave","cell-click","cell-dblclick","cell-mouseenter","cell-mouseleave","update:page-size"],setup(t,{expose:p,emit:g}){const y=g,i=t;let m=e.ref([]),a=e.ref([]),o=[],f=[],b=e.ref([]),h=[],k=[],R=e.ref(!1),$=e.ref(!1),T=e.ref(-1),N=e.ref(0),De=e.ref(i.toolbarActions.map(l=>(l.params=[b.value],l))),Fe=e.computed(()=>i.i18nCheckedStatus.replace(":checked",b.value.length).replace(":total",a.value.length)),v=e.ref(1),u=e.ref(i.pageSize),S=e.computed(()=>Math.ceil(N.value/u.value)),Me=e.computed(()=>{let l=[];for(let d=1;d<=S.value;d++)l.push(d);return l}),Le=e.computed(()=>i.i18nPaging.replace(":page_count",S.value).replace(":page",v.value).replace(":row_total",N.value)),w=[];const O=e.ref(),H=e.ref(),P=e.ref(),Re=e.ref(),U=e.ref(),z=e.ref();e.watch(()=>i.columns,l=>{R.value=l.filter(r=>r.type==="checkbox").length>0;let d=["checkbox","index"],n=-1;for(let r=0;r<l.length;r++)if(l[r].fixed==="left")n=r;else if(d.indexOf(l[r].type)===-1)break;if(T.value=n,n!==-1)for(let r=0;r<l.length;r++)l[r].type==="checkbox"?(l[r].width=l[r].width||40,l[r].fixed="left"):l[r].type==="index"&&(l[r].width=l[r].width||60,l[r].fixed="left");let c=[];for(let r=0;r<l.length&&l[r].fixed==="left";r++)c[r]=c[r-1]!==void 0?c[r-1]+l[r-1].width:0;let s=[];for(let r=l.length-1;r>=0&&l[r].fixed==="right";r--)s[r]+=s[r+1]||0;const C=function(r){let x=r.filter;const B={select:{type:e.markRaw(ce),op:"="},text:{type:e.markRaw(ie),op:"like"},date:{type:"v3-d-table-filter-date-range",op:"date"}};return B[x.type]&&(!x.op&&(x.op=B[x.type].op),x.type=B[x.type].type),x.f=r.field||r.code,x.v=e.ref(),x};let G=[];h=[],l.forEach((r,x)=>{let B=r.filter?C(r):!1;B&&h.push(B),G.push({code:r.code||r.field,type:r.type||"data",field:r.field||!1,hidden:r.hidden||!1,title:r.title||!1,width:r.width||!1,sort:r.sort||!1,sortDir:r.sortDir||!1,renderer:r.renderer||!1,filter:B,expandable:r.expandable||!1,actions:r.actions||!1,cssClass:{data:r.type==="data"||r.type===void 0,"align-center":r.align==="center","align-right":r.align==="right",sort:r.sort,asc:r.sortDir==="asc",desc:r.sortDir==="desc"},style:{left:r.fixed?c[x]+"px":"unset",right:r.fixed?s[x]+"px":"unset",position:r.fixed?"sticky":"unset",zIndex:r.fixed?2:1,width:r.width?r.width+"px":"auto"}}),r.width&&($.value=!0)}),m=e.ref(G)},{immediate:!0}),e.watch(()=>u.value,l=>{W(l)});const A=function(l){let d=[];return l.forEach(n=>{d.push(n),n.children&&n.children.length>0&&d.push(...A(n.children))}),d},D=function(){let l=!0,d=!1;A(a.value).forEach(n=>{n._checked_?d=!0:l=!1}),z.value[0].checked=l,z.value[0].indeterminate=!l&&d},Te=function(l){A(a.value).forEach(d=>{d._checked_=l,l?b.value.push(d):b.value.splice(b.value.indexOf(d),1)})},j=function(l,d){l._checked_=d,d?b.value.push(l):b.value.splice(b.value.indexOf(l),1),D()},Oe=function(l){j(l,!l._checked_),y("row-click",l)},He=function(){o=f.filter(l=>{let d=h.concat(k);for(let n=0;n<d.length;n++){let c=d[n];if(!(!l[c.f]||c.v.value===""||c.v.value===null||c.v.value===void 0)){if(c.op==="="&&l[c.f]+""!=c.v.value+"")return!1;if(c.op==="like"&&(l[c.f]+"").indexOf(c.v.value+"")===-1)return!1;c.op}}return!0}),a.value=o.slice(0,u.value),N.value=o.length,v.value=1},I=function(){i.srcUrl?F():He()},q=function(l){a.value=l.data,N.value=l.total},F=function(){if(i.srcHandler instanceof Function)i.srcHandler(q,i);else{let l=new XMLHttpRequest,d=i.srcUrl,n="";i.srcMethod.toUpperCase()==="GET"?d=i.srcUrl.indexOf("?")===-1?`${i.srcUrl}?p=${v.value}&ps=${u.value}`:`${i.srcUrl}&p=${v.value}&ps=${u.value}`:n=`p=${v.value}&ps=${u.value}`,l.open(i.srcMethod,d);for(let c in i.srcHeaders)l.setRequestHeader(c,i.srcHeaders[c]);l.onload=()=>{q(JSON.parse(l.responseText))},l.send(n)}},Pe=function(){o.sort((l,d)=>{for(let n=0;n<w.length;n++){let c=l[w[n].field],s=d[w[n].field];if(w[n].gbk&&(c=c&&c.toString().localeCompare(s),s=s&&s.toString().localeCompare(c)),c!==s)return w[n].dir==="asc"?c>s?1:-1:c<s?1:-1}return 0}),a.value=o.slice((v.value-1)*u.value,v.value*u.value)},Ue=function(){},je=function(l){l.sort&&(w.filter(d=>d.field===l.field).length>0?(w.sort((d,n)=>d.field===l.code?-1:n.field===l.code?1:0),w[0].dir=w[0].dir==="asc"?"desc":"asc"):w.unshift({field:l.code,dir:"asc",gbk:l.gbk||!1}),l.sortDir=w[0].dir,l.cssClass.asc=l.sortDir==="asc",l.cssClass.desc=l.sortDir==="desc",i.srcUrl?Ue():Pe())},M=function(l){l<1||l>S.value||(v.value=l,i.srcUrl?F():(a.value=o.slice((v.value-1)*u.value,v.value*u.value),D()))},W=function(l){u.value=parseInt(l),v.value=1,a.value=o.slice((v.value-1)*u.value,v.value*u.value),D(),y("update:page-size",u.value)};return p({filter:I}),i.autoLoad&&(i.srcUrl?F():(f=i.data,o=i.data,a.value=o.slice((v.value-1)*u.value,v.value*u.value),N.value=o.length)),e.onMounted(()=>{i.height&&(O.value.style.height=`calc(100% - ${U.value.offsetHeight}px)`,P.value.style.top=`${H.value.offsetHeight}px`)}),(l,d)=>(e.openBlock(),e.createElementBlock("div",{class:"v3-d-table",style:e.normalizeStyle({height:t.height}),ref:"elTable"},[e.createElementVNode("div",{class:"v3-d-table-main",ref_key:"elMain",ref:O},[t.showToolbar?(e.openBlock(),e.createElementBlock("div",{key:0,class:"v3-d-table-toolbar",ref_key:"elToolbar",ref:H},[e.createElementVNode("div",be,[e.createElementVNode("div",pe,[e.createVNode(L,{actions:e.unref(De)},null,8,["actions"]),e.unref(R)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"v3-d-table-header-checked-status",textContent:e.toDisplayString(e.unref(Fe))},null,8,fe)):e.createCommentVNode("",!0)]),e.createElementVNode("div",null,[e.renderSlot(l.$slots,"toolbar-left")])]),e.createElementVNode("div",he,[e.renderSlot(l.$slots,"toolbar-right")])],512)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"v3-d-table-header",ref_key:"elHeader",ref:P},[e.createElementVNode("table",null,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(n,c)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[n.type==="checkbox"?(e.openBlock(),e.createElementBlock("th",{key:0,class:"checkbox",style:e.normalizeStyle(n.style)},[e.createElementVNode("div",null,[e.createElementVNode("input",{ref_for:!0,ref_key:"elCheckAll",ref:z,type:"checkbox",onClick:d[0]||(d[0]=s=>Te(s.currentTarget.checked))},null,512)])],4)):e.createCommentVNode("",!0),n.type==="index"?(e.openBlock(),e.createElementBlock("th",{key:1,class:"index",style:e.normalizeStyle(n.style)},[e.createElementVNode("div",{textContent:e.toDisplayString(n.title||"#")},null,8,ve)],4)):e.createCommentVNode("",!0),n.type==="actions"?(e.openBlock(),e.createElementBlock("th",{key:2,class:"actions",style:e.normalizeStyle(n.style)},[e.createElementVNode("div",{textContent:e.toDisplayString(n.title||"")},null,8,me)],4)):e.createCommentVNode("",!0),n.type==="data"&&!n.hidden?(e.openBlock(),e.createElementBlock("th",{key:3,class:e.normalizeClass(n.cssClass),style:e.normalizeStyle(n.style)},[e.createElementVNode("div",{onClick:s=>je(n)},[e.createElementVNode("span",{textContent:e.toDisplayString(n.title)},null,8,ue)],8,ke)],6)):e.createCommentVNode("",!0)],64))),256)),e.unref($)?(e.openBlock(),e.createElementBlock("th",ge)):e.createCommentVNode("",!0)]),t.showColumnFilter?(e.openBlock(),e.createElementBlock("tr",ye,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(n,c)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[n.type==="checkbox"?(e.openBlock(),e.createElementBlock("th",{key:0,class:"checkbox",style:e.normalizeStyle(n.style)},null,4)):e.createCommentVNode("",!0),n.type==="index"?(e.openBlock(),e.createElementBlock("th",{key:1,class:"index",style:e.normalizeStyle(n.style)},null,4)):e.createCommentVNode("",!0),n.type==="actions"?(e.openBlock(),e.createElementBlock("th",{key:2,class:"actions",style:e.normalizeStyle(n.style)},null,4)):e.createCommentVNode("",!0),n.type==="data"&&!n.hidden?(e.openBlock(),e.createElementBlock("th",{key:3,style:e.normalizeStyle(n.style)},[n.filter?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n.filter.type),{key:0,props:n.filter.params,value:n.filter.v,"onUpdate:value":s=>n.filter.v=s,onExecute:I},null,40,["props","value","onUpdate:value"])):e.createCommentVNode("",!0)],4)):e.createCommentVNode("",!0)],64))),256)),e.unref($)?(e.openBlock(),e.createElementBlock("th",xe)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)])])],512),e.createElementVNode("div",{class:"v3-d-table-body",ref_key:"elBody",ref:Re},[e.createElementVNode("table",null,[e.createElementVNode("tbody",null,[e.unref(a).length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(e.unref(a),(n,c)=>(e.openBlock(),e.createBlock(de,{idx:c,row:n,cols:e.unref(m),"show-auto-width-col":e.unref($),"empty-value":t.emptyValue,"last-left-fixed-col-idx":e.unref(T),"activated-rows":e.unref(b),onClick:d[1]||(d[1]=s=>Oe(s)),onDblclick:d[2]||(d[2]=s=>l.$emit("row-dblclick",s)),onMouseenter:d[3]||(d[3]=s=>l.$emit("row-mouseenter",s)),onMouseleave:d[4]||(d[4]=s=>l.$emit("row-mouseleave",s)),onCheck:d[5]||(d[5]=(s,C)=>j(s,C)),onCellClick:d[6]||(d[6]=(s,C)=>l.$emit("cell-click",s,C)),onCellDblclick:d[7]||(d[7]=(s,C)=>l.$emit("cell-dblclick",s,C)),onCellMouseenter:d[8]||(d[8]=(s,C)=>l.$emit("cell-mouseenter",s,C)),onCellMouseleave:d[9]||(d[9]=(s,C)=>l.$emit("cell-mouseleave",s,C))},null,8,["idx","row","cols","show-auto-width-col","empty-value","last-left-fixed-col-idx","activated-rows"]))),256)):(e.openBlock(),e.createElementBlock("tr",we,[e.createElementVNode("td",{colspan:e.unref(m).length,class:"no-data"},[e.createElementVNode("div",{textContent:e.toDisplayString(t.i18nNoData)},null,8,Be)],8,Ce)]))])])],512)],512),e.createElementVNode("div",{class:"v3-d-table-footer",ref_key:"elFooter",ref:U},[e.createElementVNode("div",Ee,[e.createElementVNode("select",{onChange:d[10]||(d[10]=n=>W(n.currentTarget.value))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.pageSizes,n=>(e.openBlock(),e.createElementBlock("option",{value:n,selected:n===e.unref(u),textContent:e.toDisplayString(n)},null,8,Ne))),256))],32)]),e.createElementVNode("div",{textContent:e.toDisplayString(e.unref(Le))},null,8,Ve),e.createElementVNode("div",$e,[e.createElementVNode("a",{href:"#",class:e.normalizeClass({disabled:e.unref(v)===1}),textContent:e.toDisplayString(i.i18nPrevPage),onClick:d[11]||(d[11]=e.withModifiers(n=>M(e.unref(v)-1),["prevent"]))},null,10,Se),e.createElementVNode("select",{onChange:d[12]||(d[12]=n=>M(n.currentTarget.value))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(Me),n=>(e.openBlock(),e.createElementBlock("option",{value:n,selected:n===e.unref(v),textContent:e.toDisplayString(n)},null,8,ze))),256))],32),e.createElementVNode("a",{href:"#",class:e.normalizeClass({disabled:e.unref(v)===e.unref(S)}),textContent:e.toDisplayString(i.i18nNextPage),onClick:d[13]||(d[13]=e.withModifiers(n=>M(e.unref(v)+1),["prevent"]))},null,10,Ae)])],512),d[14]||(d[14]=e.createElementVNode("div",{class:"v3-d-table-loader"},null,-1))],4))}}});
